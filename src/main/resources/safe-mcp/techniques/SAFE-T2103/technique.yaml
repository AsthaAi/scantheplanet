id: SAFE-T2103
name: Code Sabotage via Malicious PR
severity: P0
summary: 'Automated PR creation with malicious code changes or CI/CD pipeline manipulation'
description: 'Code Sabotage via Malicious PR uses MCP tools with repository access to create automated
  pull requests containing malicious code changes, backdoors, or CI/CD pipeline modifications.
  Attackers manipulate build scripts, inject vulnerabilities, or alter deployment configurations
  through automated commits that bypass normal code review.'
mitigations:
- SAFE-M-2
- SAFE-M-3
code_signals:
- id: SAFE-T2103.signal.automated_pr
  description: Detects automated PR creation with suspicious patterns
  heuristics:
  - regex: 'createPullRequest|create_pull_request|gh\s+pr\s+create'
    flags: i
  - regex: 'git\s+push.*(?:--force|-f)'
  - regex: '(?:auto|bot).*(?:commit|push|merge|pr)'
    flags: i
  - regex: 'git\s+commit.*(?:-m|--message).*(?:auto|bot|fix|update)'
    flags: i
- id: SAFE-T2103.signal.cicd_manipulation
  description: Detects CI/CD pipeline file modification
  heuristics:
  - regex: '(?:write|modify|edit).*(?:\.github/workflows|\.gitlab-ci|Jenkinsfile|\.circleci)'
    flags: i
  - regex: '(?:yaml|yml).*(?:pipeline|workflow|action|deploy)'
    flags: i
  - regex: 'Dockerfile.*(?:modify|write|edit|create)'
    flags: i
  - regex: '(?:script|command).*(?:deploy|release|publish)'
    flags: i
- id: SAFE-T2103.signal.code_injection
  description: Detects code injection patterns in automated changes
  heuristics:
  - regex: 'git\s+(?:add|commit).*(?:\.env|secret|credential|config)'
    flags: i
  - regex: '(?:eval|exec|system|spawn).*(?:inject|backdoor|payload)'
    flags: i
  - regex: '(?:write|append).*(?:authorized_keys|sudoers|crontab)'
    flags: i
languages:
- typescript
- javascript
- python
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - partial
  - unknown
