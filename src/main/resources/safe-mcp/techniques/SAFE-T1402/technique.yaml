id: SAFE-T1402
name: Instruction Stenography
severity: P1
summary: 'Hidden instructions embedded via HTML comments, zero-width chars, or Unicode bidi overrides'
description: 'Instruction Stenography conceals malicious instructions within tool descriptions or
  metadata using steganographic techniques: HTML comments, zero-width Unicode characters, bidirectional
  text overrides, or invisible formatting. These hidden instructions are processed by LLMs but
  invisible in standard UI rendering.'
mitigations:
- SAFE-M-1
- SAFE-M-6
code_signals:
- id: SAFE-T1402.signal.html_comments
  description: Detects HTML comments used to hide instructions in tool metadata
  heuristics:
  - regex: '<!--\s*(?:SYSTEM|INSTRUCTION|OVERRIDE|IGNORE|IMPORTANT)'
    flags: i
  - regex: '<!--[^>]{50,}-->'
  - pattern: '<!-- hidden'
  - pattern: '<!--hidden'
- id: SAFE-T1402.signal.zero_width_chars
  description: Detects zero-width Unicode characters used for steganography
  heuristics:
  - pattern: '\u200b'
  - pattern: '\u200c'
  - pattern: '\u200d'
  - pattern: '\u2060'
  - pattern: '\ufeff'
  - regex: '\\u200[0-9a-fA-F]'
  - regex: '\\u206[0-9a-fA-F]'
  - pattern: '\u00ad'
- id: SAFE-T1402.signal.bidi_override
  description: Detects Unicode bidirectional overrides that reorder displayed text
  heuristics:
  - pattern: '\u202a'
  - pattern: '\u202b'
  - pattern: '\u202c'
  - pattern: '\u202d'
  - pattern: '\u202e'
  - pattern: '\u2066'
  - pattern: '\u2067'
  - pattern: '\u2068'
  - pattern: '\u2069'
  - regex: '\\u202[a-eA-E]'
languages:
- typescript
- javascript
- python
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - partial
  - unknown
