id: SAFE-T1803
name: Database Dump
severity: P0
summary: 'Bulk database export via SELECT *, mysqldump, pg_dump, or similar tools'
description: 'Database Dump extracts entire database contents through MCP tools using bulk export
  commands like mysqldump, pg_dump, SELECT *, or ORM findAll without pagination. This enables
  mass exfiltration of structured data including user records, credentials, financial data,
  and other sensitive information stored in databases.'
mitigations:
- SAFE-M-3
- SAFE-M-6
code_signals:
- id: SAFE-T1803.signal.dump_commands
  description: Detects database dump command usage
  heuristics:
  - pattern: 'mysqldump'
  - pattern: 'pg_dump'
  - pattern: 'mongodump'
  - pattern: 'sqlite3 .dump'
  - regex: 'redis-cli.*(?:dump|save|bgsave)'
    flags: i
  - regex: 'COPY\s+\w+\s+TO\s'
    flags: i
- id: SAFE-T1803.signal.bulk_queries
  description: Detects bulk data extraction queries
  heuristics:
  - regex: 'SELECT\s+\*\s+FROM\s+\w+\s*(?:;|$)'
    flags: i
  - regex: '\.findAll\s*\(\s*\)'
  - regex: '\.find\s*\(\s*\{\s*\}\s*\)'
  - regex: 'collection\.find\s*\(\s*\)'
  - regex: 'Model\.objects\.all\s*\(\s*\)'
  - regex: 'SELECT.*(?:WITHOUT|NO)\s+LIMIT'
    flags: i
- id: SAFE-T1803.signal.export_operations
  description: Detects database export to file operations
  heuristics:
  - regex: '(?:INTO|TO)\s+(?:OUTFILE|DUMPFILE)\s'
    flags: i
  - regex: 'cursor\.(?:fetchall|fetchmany)\s*\(\s*\)'
  - regex: 'to_csv|to_json|to_parquet'
    flags: i
  - regex: '(?:export|backup).*(?:database|table|collection)'
    flags: i
languages:
- typescript
- javascript
- python
- go
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - partial
  - unknown
