id: SAFE-T1505
name: In-Memory Secret Extraction
severity: P0
summary: 'Memory inspection or process memory dumps used to extract secrets at runtime'
description: 'In-Memory Secret Extraction targets secrets held in process memory at runtime. Attackers
  use memory dump tools, /proc/*/mem access, heap inspection, or debugger attachment to extract
  encryption keys, tokens, passwords, and other sensitive data that exists only in memory and
  would not be found in files or environment variables.'
mitigations:
- SAFE-M-3
code_signals:
- id: SAFE-T1505.signal.memory_dump
  description: Detects memory dump and inspection patterns
  heuristics:
  - regex: '/proc/\d+/(?:mem|maps|smaps|environ)'
  - regex: '/proc/self/(?:mem|maps|environ)'
  - pattern: 'process_vm_readv'
  - pattern: 'ReadProcessMemory'
  - regex: 'ptrace\s*\(\s*PTRACE_(?:PEEKDATA|PEEKTEXT|ATTACH)'
  - pattern: 'MiniDumpWriteDump'
  - regex: 'gcore\s+'
- id: SAFE-T1505.signal.heap_inspection
  description: Detects heap inspection and memory scanning patterns
  heuristics:
  - pattern: 'v8.getHeapSnapshot'
  - pattern: 'gc.get_objects()'
  - pattern: 'gc.get_referrers'
  - regex: 'heapdump|heap_dump|heap-dump'
    flags: i
  - regex: 'memory.*(?:scan|search|dump|inspect)'
    flags: i
  - pattern: 'objgraph'
  - pattern: 'pympler'
- id: SAFE-T1505.signal.core_dump
  description: Detects core dump generation and analysis
  heuristics:
  - regex: 'ulimit\s+-c\s+unlimited'
  - pattern: 'core_pattern'
  - regex: 'gdb.*(?:dump|x/|info proc)'
    flags: i
  - regex: 'strings\s+.*(?:core|dump|\.mem)'
    flags: i
  - pattern: 'RLIMIT_CORE'
languages:
- typescript
- javascript
- python
- go
- rust
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - partial
  - unknown
