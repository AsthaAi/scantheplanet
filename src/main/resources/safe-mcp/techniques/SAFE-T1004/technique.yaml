id: SAFE-T1004
name: Server Impersonation / Name-Collision
severity: P1
summary: 'MCP server impersonates legitimate service through DNS or name collision'
description: 'Server Impersonation occurs when an attacker registers an MCP server with a name designed to
  be confused with a legitimate service (typosquatting, homograph attacks, or DNS cache poisoning). Users
  connecting to the impersonated server unknowingly send credentials and data to the attacker.'
mitigations:
- SAFE-M-10
code_signals:
- id: SAFE-T1004.signal.typosquat_patterns
  description: Detects common typosquatting patterns in server names or URLs
  heuristics:
  - regex: '(?:serv[ei]r|s[3e]rver|sevrer)'
    flags: i
  - regex: '(?:googl[3e]|go0gle|g00gle)'
    flags: i
  - regex: '(?:githuh|g1thub|guthub)'
    flags: i
  - regex: 'xn--[a-z0-9]+'
    flags: i
- id: SAFE-T1004.signal.dns_config
  description: Detects DNS-related configuration that could enable impersonation
  heuristics:
  - pattern: 'dns.setServers'
  - pattern: 'custom_dns'
  - pattern: 'dns_resolver'
  - pattern: 'hosts_file'
  - regex: 'resolv\.conf'
  - regex: 'dns\.resolve\s*\('
- id: SAFE-T1004.signal.cert_bypass
  description: Detects TLS certificate validation bypass
  heuristics:
  - pattern: 'rejectUnauthorized: false'
  - pattern: 'verify=False'
  - pattern: 'InsecureSkipVerify: true'
  - pattern: 'CERT_NONE'
  - pattern: 'ssl._create_unverified_context'
  - pattern: 'NODE_TLS_REJECT_UNAUTHORIZED'
languages:
- typescript
- javascript
- python
- go
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - partial
  - unknown
