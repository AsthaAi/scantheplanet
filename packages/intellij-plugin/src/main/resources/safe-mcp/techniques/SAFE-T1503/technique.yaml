id: SAFE-T1503
name: 'SAFE-T1503: Env-Var Scraping'
severity: high
summary: |-
  Env-var scraping when user-controlled input reads arbitrary environment variables
  or exposes them to tool output.
description: |-
  Tactic: Credential Access (ATK-TA0006). Technique: SAFE-T1503. Severity: high.
  Detection guidance:
  - Require user-controlled variable names or iteration over process environment.
  - Confirm the values are returned to the user, LLM, or logs.
  Exclusions:
  - Do not flag fixed-key environment reads used only for outbound auth (for example,
    API keys placed in request headers).
mitigations: []
code_signals:
- id: SAFE-T1503-signal-1
  description: Potential indicators for this technique in code or configuration.
  heuristics:
  - pattern: '*safe*'
  - pattern: '*t1503*'
  - pattern: '*scraping*'
languages: []
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - unknown
llm_required: true
