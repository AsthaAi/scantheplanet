id: SAFE-T1105
name: 'SAFE-T1105: Path Traversal via File Tool'
severity: high
summary: |-
  Path traversal via file tool when untrusted input controls local filesystem paths
  without normalization, allowlisting, or sandboxing.
description: |-
  Tactic: Execution (ATK-TA0002). Technique: SAFE-T1105. Severity: high.
  Detection guidance:
  - Require a local file read/write/delete where the path comes from untrusted input.
  - Identify missing normalization or allowlist checks (e.g., no Path.resolve, no
    base directory enforcement, no path sanitization).
  Exclusions:
  - Do not flag network URL fetches or HTTP requests that do not access the local filesystem.
mitigations: []
code_signals:
- id: SAFE-T1105-signal-1
  description: Potential indicators for this technique in code or configuration.
  heuristics:
  - pattern: '*safe*'
  - pattern: '*t1105*'
  - pattern: '*path*'
  - pattern: '*traversal*'
  - pattern: '*file*'
languages: []
output_schema:
  requires_mitigations: false
  allowed_status_values:
  - pass
  - fail
  - unknown
llm_required: true
